{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/sickdays/front/src/shared/router/routesEnum.ts"],"sourcesContent":["export enum RoutesEnum {\r\n  HOME = \"/\",\r\n  LOGIN = \"/auth/login\",\r\n  REGISTRATION = \"/auth/register\",\r\n  TICKETS = \"/home/tickets\",\r\n  REQUESTS = \"/requests\",\r\n}\r\n"],"names":[],"mappings":";;;AAAO,IAAA,AAAK,oCAAA;;;;;;WAAA","debugId":null}},
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/sickdays/front/src/shared/utils/getJwtTokenOnServer.ts"],"sourcesContent":["import { cookies } from \"next/headers\"\r\n\r\nexport async function getJwtTokenOnServer() {\r\n  if (typeof window !== \"undefined\") return undefined\r\n\r\n  const cookieStore = await cookies()\r\n  return cookieStore.get(\"accessToken\")?.value\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAEO,eAAe;QAIb;IAHP,wCAAmC,OAAO;;;IAE1C,MAAM;AAER","debugId":null}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/sickdays/front/src/shared/api/index.ts"],"sourcesContent":["import axios from \"axios\"\r\nimport { getJwtTokenOnServer } from \"../utils/getJwtTokenOnServer\"\r\n\r\nexport const AxiosServerInstance = axios.create({\r\n  baseURL: process.env.NEXT_PUBLIC_API_REDIRECT_URL,\r\n  withCredentials: true,\r\n})\r\n\r\nexport const AxiosInstance = axios.create({\r\n  baseURL: \"/api\",\r\n  withCredentials: true,\r\n})\r\n\r\nAxiosServerInstance.interceptors.request.use(\r\n  async config => {\r\n    const token = getJwtTokenOnServer()\r\n\r\n    if (config.headers) config.headers.Authorization = token ? `Bearer ${token}` : \"\"\r\n    return config\r\n  },\r\n  error => {\r\n    return Promise.reject(error)\r\n  }\r\n)\r\nAxiosInstance.interceptors.request.use(\r\n  async config => {\r\n    if (config.headers) config.headers[\"Content-Type\"] = \"application/json\"\r\n\r\n    return config\r\n  },\r\n  error => {\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\nAxiosInstance.interceptors.response.use(\r\n  response => {\r\n    return response\r\n  },\r\n  async (error: any) => {\r\n    const originalRequest = error.config\r\n    if (\r\n      error.response?.status === 401 &&\r\n      !originalRequest.url?.includes(\"/auth/login\") &&\r\n      !originalRequest.url?.includes(\"/auth/refresh\") &&\r\n      !originalRequest.url?.includes(\"/auth/register\") &&\r\n      !originalRequest._retry\r\n    ) {\r\n      originalRequest._retry = true\r\n      try {\r\n        const refreshToken = typeof localStorage !== \"undefined\" ? localStorage.getItem(\"refreshToken\") : undefined\r\n        const refreshRes = await AxiosInstance.post(\"/auth/refresh\", { refreshToken })\r\n        const newToken = refreshRes.data.accessToken\r\n        if (typeof sessionStorage !== \"undefined\") {\r\n          sessionStorage.setItem(\"accessToken\", newToken)\r\n        }\r\n        // ensure headers before mutation\r\n        if (!originalRequest.headers) originalRequest.headers = {}\r\n        originalRequest.headers.Authorization = `Bearer ${newToken}`\r\n        return AxiosInstance(originalRequest)\r\n      } catch (refreshError) {\r\n        console.error(\"Failed to refresh token\", refreshError)\r\n        return Promise.reject(refreshError)\r\n      }\r\n    }\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n"],"names":[],"mappings":";;;;AAIW;AAJX;AACA;;;AAEO,MAAM,sBAAsB,wIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IAC9C,OAAO;IACP,iBAAiB;AACnB;AAEO,MAAM,gBAAgB,wIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IACxC,SAAS;IACT,iBAAiB;AACnB;AAEA,oBAAoB,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1C,OAAM;IACJ,MAAM,QAAQ,CAAA,GAAA,gJAAA,CAAA,sBAAmB,AAAD;IAEhC,IAAI,OAAO,OAAO,EAAE,OAAO,OAAO,CAAC,aAAa,GAAG,QAAQ,AAAC,UAAe,OAAN,SAAU;IAC/E,OAAO;AACT,GACA,CAAA;IACE,OAAO,QAAQ,MAAM,CAAC;AACxB;AAEF,cAAc,YAAY,CAAC,OAAO,CAAC,GAAG,CACpC,OAAM;IACJ,IAAI,OAAO,OAAO,EAAE,OAAO,OAAO,CAAC,eAAe,GAAG;IAErD,OAAO;AACT,GACA,CAAA;IACE,OAAO,QAAQ,MAAM,CAAC;AACxB;AAGF,cAAc,YAAY,CAAC,QAAQ,CAAC,GAAG,CACrC,CAAA;IACE,OAAO;AACT,GACA,OAAO;QAGH,iBACC,sBACA,uBACA;IALH,MAAM,kBAAkB,MAAM,MAAM;IACpC,IACE,EAAA,kBAAA,MAAM,QAAQ,cAAd,sCAAA,gBAAgB,MAAM,MAAK,OAC3B,GAAC,uBAAA,gBAAgB,GAAG,cAAnB,2CAAA,qBAAqB,QAAQ,CAAC,mBAC/B,GAAC,wBAAA,gBAAgB,GAAG,cAAnB,4CAAA,sBAAqB,QAAQ,CAAC,qBAC/B,GAAC,wBAAA,gBAAgB,GAAG,cAAnB,4CAAA,sBAAqB,QAAQ,CAAC,sBAC/B,CAAC,gBAAgB,MAAM,EACvB;QACA,gBAAgB,MAAM,GAAG;QACzB,IAAI;YACF,MAAM,eAAe,OAAO,iBAAiB,cAAc,aAAa,OAAO,CAAC,kBAAkB;YAClG,MAAM,aAAa,MAAM,cAAc,IAAI,CAAC,iBAAiB;gBAAE;YAAa;YAC5E,MAAM,WAAW,WAAW,IAAI,CAAC,WAAW;YAC5C,IAAI,OAAO,mBAAmB,aAAa;gBACzC,eAAe,OAAO,CAAC,eAAe;YACxC;YACA,iCAAiC;YACjC,IAAI,CAAC,gBAAgB,OAAO,EAAE,gBAAgB,OAAO,GAAG,CAAC;YACzD,gBAAgB,OAAO,CAAC,aAAa,GAAG,AAAC,UAAkB,OAAT;YAClD,OAAO,cAAc;QACvB,EAAE,OAAO,cAAc;YACrB,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IACA,OAAO,QAAQ,MAAM,CAAC;AACxB","debugId":null}},
    {"offset": {"line": 114, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/sickdays/front/src/features/LoginUser/api/index.tsx"],"sourcesContent":["import { AxiosInstance } from \"../../../shared/api\"\r\nimport { LoginCredentials, TokenResponse } from \"../types\"\r\n\r\nexport const loginRequest = async (credentials: LoginCredentials) => {\r\n  return await AxiosInstance.post<TokenResponse | { error: string }>(`/auth/login`, { ...credentials })\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAGO,MAAM,eAAe,OAAO;IACjC,OAAO,MAAM,gIAAA,CAAA,gBAAa,CAAC,IAAI,CAAqC,eAAc;QAAE,GAAG,WAAW;IAAC;AACrG","debugId":null}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/sickdays/front/src/features/LoginUser/ui/index.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport FormItem from \"antd/es/form/FormItem\"\r\nimport { useState } from \"react\"\r\nimport { useForm } from \"antd/es/form/Form\"\r\nimport { Button, Flex, Form, Input, message } from \"antd\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { RoutesEnum } from \"../../../shared/router/routesEnum\"\r\nimport { LoginCredentials } from \"../types\"\r\nimport { loginRequest } from \"../api\"\r\n\r\nexport const LoginUserUI = () => {\r\n  const [isLoading, setLoading] = useState<boolean>(false)\r\n\r\n  const [form] = useForm<LoginCredentials>()\r\n\r\n  const router = useRouter()\r\n\r\n  const SignInHandler = () => {\r\n    router.push(RoutesEnum.REGISTRATION)\r\n  }\r\n\r\n  const successAction = async (payload: LoginCredentials) => {\r\n    setLoading(true)\r\n    loginRequest(payload)\r\n      .then(() => {\r\n        router.push(RoutesEnum.HOME)\r\n      })\r\n      .catch(error => {\r\n        message.error(error.message || \"Ошибка входа, попробуйте позже\")\r\n      })\r\n      .finally(() => {\r\n        setLoading(false)\r\n      })\r\n  }\r\n\r\n  return (\r\n    <Form\r\n      form={form}\r\n      name='loginForm'\r\n      layout='vertical'\r\n      onFinish={successAction}\r\n    >\r\n      <FormItem\r\n        label={\"Логин\"}\r\n        name={\"login\"}\r\n        rules={[{ message: \"Пожалуйста, введите ваш логин\" }]}\r\n        required\r\n      >\r\n        <Input placeholder='username@gmail.com' />\r\n      </FormItem>\r\n      <FormItem\r\n        label={\"Пароль\"}\r\n        name={\"password\"}\r\n        rules={[{ message: \"Пожалуйста, введите пароль\" }]}\r\n        required\r\n      >\r\n        <Input\r\n          type='password'\r\n          placeholder='*********'\r\n        />\r\n      </FormItem>\r\n      <FormItem>\r\n        <Flex gap='16px'>\r\n          <Button\r\n            block\r\n            color='default'\r\n            onClick={SignInHandler}\r\n          >\r\n            Регистрация\r\n          </Button>\r\n          <Button\r\n            block\r\n            loading={isLoading}\r\n            disabled={isLoading}\r\n            type='primary'\r\n            htmlType='submit'\r\n            form='loginForm'\r\n          >\r\n            Войти\r\n          </Button>\r\n        </Flex>\r\n      </FormItem>\r\n    </Form>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;;;AATA;;;;;;;;AAWO,MAAM,cAAc;;IACzB,MAAM,CAAC,WAAW,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAW;IAElD,MAAM,CAAC,KAAK,GAAG,CAAA,GAAA,+LAAA,CAAA,UAAO,AAAD;IAErB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,MAAM,gBAAgB;QACpB,OAAO,IAAI,CAAC,wIAAA,CAAA,aAAU,CAAC,YAAY;IACrC;IAEA,MAAM,gBAAgB,OAAO;QAC3B,WAAW;QACX,CAAA,GAAA,gJAAA,CAAA,eAAY,AAAD,EAAE,SACV,IAAI,CAAC;YACJ,OAAO,IAAI,CAAC,wIAAA,CAAA,aAAU,CAAC,IAAI;QAC7B,GACC,KAAK,CAAC,CAAA;YACL,uLAAA,CAAA,UAAO,CAAC,KAAK,CAAC,MAAM,OAAO,IAAI;QACjC,GACC,OAAO,CAAC;YACP,WAAW;QACb;IACJ;IAEA,qBACE,6LAAC,iLAAA,CAAA,OAAI;QACH,MAAM;QACN,MAAK;QACL,QAAO;QACP,UAAU;;0BAEV,6LAAC,0JAAA,CAAA,UAAQ;gBACP,OAAO;gBACP,MAAM;gBACN,OAAO;oBAAC;wBAAE,SAAS;oBAAgC;iBAAE;gBACrD,QAAQ;0BAER,cAAA,6LAAC,mLAAA,CAAA,QAAK;oBAAC,aAAY;;;;;;;;;;;0BAErB,6LAAC,0JAAA,CAAA,UAAQ;gBACP,OAAO;gBACP,MAAM;gBACN,OAAO;oBAAC;wBAAE,SAAS;oBAA6B;iBAAE;gBAClD,QAAQ;0BAER,cAAA,6LAAC,mLAAA,CAAA,QAAK;oBACJ,MAAK;oBACL,aAAY;;;;;;;;;;;0BAGhB,6LAAC,0JAAA,CAAA,UAAQ;0BACP,cAAA,6LAAC,iLAAA,CAAA,OAAI;oBAAC,KAAI;;sCACR,6LAAC,qMAAA,CAAA,SAAM;4BACL,KAAK;4BACL,OAAM;4BACN,SAAS;sCACV;;;;;;sCAGD,6LAAC,qMAAA,CAAA,SAAM;4BACL,KAAK;4BACL,SAAS;4BACT,UAAU;4BACV,MAAK;4BACL,UAAS;4BACT,MAAK;sCACN;;;;;;;;;;;;;;;;;;;;;;;AAOX;GA1Ea;;QAGI,+LAAA,CAAA,UAAO;QAEP,qIAAA,CAAA,YAAS;;;KALb","debugId":null}}]
}